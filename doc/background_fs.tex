\section{Filesystems}
\idx{Filesystem}

% what(for a computer)
Most computers organize persisted data in files. That the data are persisted\idx{Persistence} means that the data will survive a power cycle\idx{Power cycle} of the computer (i.e., that it is turned off and on again). All data available to the operating system (includin programs and configuration) is stored in files.

% what: tree
Filesystems are \textsl{mostly} tree structures, organizing files in directories. A directory\idx{Directory} is a special form of file that can group other files. In tree terminology, they are branch nodes whereas ordinary files are leaf nodes. The visual metaphore that graphical user interfaces use to refer to directories is the folder. But at the filesystem level -- which is what we care about as programmers -- it is a directory. Figure \ref{fig:bs:fs} shows what a typical filesystem could look like.

\begin{figure}[tbp]
  \input{figs/fs.tex}
  \caption{Example of a filesystem.}
  \label{fig:bs:fs}
\end{figure}

\subsection{Mounting}

Removable media, like a USB drive, are usually formatted to contain a filesystem. That is why we can place images and documents on it. In order to access that filesystem on your computer it must be mounted once attached. A mount\idx{Mounting} operation essentially makes a specific directory -- the mountpoint\idx{Mount point} -- a shorthand of the root of the mounted filesystem, thereby practically grafting the mounted filesystem to the root\idxx{Filesystem!Root}{Root filesystem} filesystem. The result of the mount operation is illustrated in figure \ref{fig:bs:fs:mounting}. On DOS\idx{DOS}-based systems (such as the Windows\idx{Windows} family of operating systems),
each known filesystem is assigned a letter, and a (hidden) root directory refers
to each of these.

\begin{figure}[tbp]
  \input{figs/fs_mounting.tex}
  \caption{Example of a mounting a guest filesystem.}
  \label{fig:bs:fs:mounting}
\end{figure}

\subsection{Links}

Modern filesystems support links though, and that is a feature that makes them break their adherence to the tree definition. A link is a special kind of file that refers to an other file (regular or directory). Figure \ref{fig:bs:fs:links} shows a scenario where a link refers to a regular file. That means that we have two paths from the root node to this regular file; one that goes through the link and one that doesn't. That means that the filesystem is no longer a tree structure. As illustrated in figure \ref{fig:bs:fs:cycles}, a link can also go backward. By pointing to a directory earlier in the path from the root node to the link node a cycle is created. This will complicate things if we need to scan the entire filesystem. Because of this, you often see commandline tools have options for following or not following links.

While modern versions of the Windows family of operating systems does have some support for links, it can be sketchy. Instead they support \textsl{shortcuts} through a special \filename{LNK} file format. The content of a file following this format is a path to a file that the link points to. While this solution is a bit more flexible, it has to be interpreted by each application instead of the filesystem and is thus harder to work with and less performant.

\begin{figure}[tbp]
  \input{figs/fs_links.tex}
  \caption{Example of a link in a filesystem.}
  \label{fig:bs:fs:links}
\end{figure}

\begin{figure}[tbp]
  \input{figs/fs_cycles.tex}
  \caption{Example of how a link can create a cycle in a filesystem.}
  \label{fig:bs:fs:cycles}
\end{figure}

\begin{figure}[tbp]
  \input{figs/fs_path_abs.tex}
  \caption{Example of an absolute path in a filesystem.}
  \label{fig:bs:fs:path:abs}
\end{figure}

\subsection{Paths}

\begin{figure}[tbp]
  \input{figs/fs_path_rel.tex}
  \caption{Example of an relative path in a filesystem.}
  \label{fig:bs:fs:path:rel}
\end{figure}

